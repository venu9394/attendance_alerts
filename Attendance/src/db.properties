#####Statements

Payroll_Statements=Hyd...

##Arrears Report for Mumbai
ArrearReport=SELECT p.EMPLOYEESEQUENCENO  EMPLOYEECODE,P.CALLNAME EMPNAME,bu.name BUNAME,dep.name Designation, CONCAT("01",".",RIGHT(A.EFFECTIVEFROM,2),".",LEFT(a.EFFECTIVEFROM,4)) 'W.E.F', CONCAT("01",".",RIGHT(a.EFFCTIVETO,2),".",LEFT(a.EFFCTIVETO,4)) 'TO', 'Increment' Type, (a.EFFCTIVETO+1)-(a.effectivefrom) 'ArrearMonths', MAX(CASE WHEN B.COMPONENTID=18 THEN B.COMPONENTVALUE END) 'TRAVEL ALLOWANCE', MAX(CASE WHEN B.COMPONENTID=22 THEN B.COMPONENTVALUE END) 'GROSS', MAX(CASE WHEN B.COMPONENTID=24 THEN B.COMPONENTVALUE END) 'BASIC', MAX(CASE WHEN B.COMPONENTID=25 THEN B.COMPONENTVALUE END) 'HRA', MAX(CASE WHEN B.COMPONENTID=26 THEN B.COMPONENTVALUE END) 'CA', MAX(CASE WHEN B.COMPONENTID=27 THEN B.COMPONENTVALUE END) 'MEDICAL', MAX(CASE WHEN B.COMPONENTID=28 THEN B.COMPONENTVALUE END) 'EDUCATION', MAX(CASE WHEN B.COMPONENTID=29 THEN B.COMPONENTVALUE END) 'SPL ALLOW', MAX(CASE WHEN B.COMPONENTID=30 THEN B.COMPONENTVALUE END) 'PT', MAX(CASE WHEN B.COMPONENTID=31 THEN B.COMPONENTVALUE END) 'PF', MAX(CASE WHEN B.COMPONENTID=32 THEN B.COMPONENTVALUE END) 'ESI', MAX(CASE WHEN B.COMPONENTID=70 THEN B.COMPONENTVALUE END) 'KIT ALLOWANCE' FROM hclhrm_prod_others.tbl_emp_arrear_list a  JOIN hclhrm_prod_others.tbl_emp_arrear_main b on b.TRANSACTIONID=a.TRANSACTIONID  JOIN hclHRM_PROD.TBL_EMPLOYEE_PRIMARY P ON P.EMPLOYEESEQUENCENO=A.EMPLOYEEID  join hcladm_prod.tbl_businessunit bu on bu.businessunitid=p.companyid  join hclhrm_prod.tbl_employee_professional_details pro on pro.employeeid=p.employeeid  join hcladm_prod.tbl_department dep on dep.DEPARTMENTID=pro.DEPARTMENTID where a.EFFCTIVETO=? and a.status='1001' group by a.employeeid union all SELECT p.employeesequenceno employeeid ,P.CALLNAME,bu.name,dep.name, '' , '' , 'NJ Arrears' Type,A.NODAYS 'Arrearsmonts', MAX(CASE WHEN B.COMPONENTID=18 THEN B.NETVALUE END) 'TRAVEL ALLOWANCE', MAX(CASE WHEN B.COMPONENTID=22 THEN B.NETVALUE END) 'GROSS', MAX(CASE WHEN B.COMPONENTID=24 THEN B.NETVALUE END) 'BASIC', MAX(CASE WHEN B.COMPONENTID=25 THEN B.NETVALUE END) 'HRA', MAX(CASE WHEN B.COMPONENTID=26 THEN B.NETVALUE END) 'CA', MAX(CASE WHEN B.COMPONENTID=27 THEN B.NETVALUE END) 'MEDICAL', MAX(CASE WHEN B.COMPONENTID=28 THEN B.NETVALUE END) 'EDUCATION', MAX(CASE WHEN B.COMPONENTID=29 THEN B.NETVALUE END) 'SPL ALLOW', MAX(CASE WHEN B.COMPONENTID=30 THEN B.NETVALUE END) 'PT', MAX(CASE WHEN B.COMPONENTID=31 THEN B.NETVALUE END) 'PF', MAX(CASE WHEN B.COMPONENTID=32 THEN B.NETVALUE END) 'ESI', MAX(CASE WHEN B.COMPONENTID=70 THEN B.NETVALUE END) 'KIT ALLOWANCE'  FROM test.tbl_employee_arrear_list a JOIN test.tbl_employee_arrear_payment b on b.refid=a.refid JOIN hclHRM_PROD.TBL_EMPLOYEE_PRIMARY P ON P.employeeid=A.EMPLOYEEID join hcladm_prod.tbl_businessunit bu on bu.businessunitid=p.companyid join hclhrm_prod.tbl_employee_professional_details pro on pro.employeeid=p.employeeid join hcladm_prod.tbl_department dep on dep.DEPARTMENTID=pro.DEPARTMENTID where a.payment=? and a.status='1001'  group by a.employeeid union all SELECT b.employeesequenceno employeeid,P.CALLNAME,bu.name, dep.name,'', '' ,'Positive/Negative' Type,b.days 'Arrearsmonts', MAX(CASE WHEN B.COMPONENTID=18 THEN B.COMPONENTVALUE END) 'TRAVEL ALLOWANCE', MAX(CASE WHEN B.COMPONENTID=22 THEN B.COMPONENTVALUE END) 'GROSS', MAX(CASE WHEN B.COMPONENTID=24 THEN B.COMPONENTVALUE END) 'BASIC', MAX(CASE WHEN B.COMPONENTID=25 THEN B.COMPONENTVALUE END) 'HRA', MAX(CASE WHEN B.COMPONENTID=26 THEN B.COMPONENTVALUE END) 'CA', MAX(CASE WHEN B.COMPONENTID=27 THEN B.COMPONENTVALUE END) 'MEDICAL', MAX(CASE WHEN B.COMPONENTID=28 THEN B.COMPONENTVALUE END) 'EDUCATION', MAX(CASE WHEN B.COMPONENTID=29 THEN B.COMPONENTVALUE END) 'SPL ALLOW', MAX(CASE WHEN B.COMPONENTID=30 THEN B.COMPONENTVALUE END) 'PT', MAX(CASE WHEN B.COMPONENTID=31 THEN B.COMPONENTVALUE END) 'PF', MAX(CASE WHEN B.COMPONENTID=32 THEN B.COMPONENTVALUE END) 'ESI', MAX(CASE WHEN B.COMPONENTID=70 THEN B.COMPONENTVALUE END) 'KIT ALLOWANCE' FROM  test.tbl_emp_lwp_list a JOIN hclHRM_PROD.TBL_EMPLOYEE_PRIMARY P ON P.employeeid=A.EMPLOYEEID join hcladm_prod.tbl_businessunit bu on bu.businessunitid=p.companyid join hclhrm_prod.tbl_employee_professional_details pro on pro.employeeid=p.employeeid join hcladm_prod.tbl_department dep on dep.DEPARTMENTID=pro.DEPARTMENTID JOIN test.tbl_employee_lwp_payments b on b.employeesequenceno=p.employeesequenceno where a.payperiod=? and a.status='1001'  group by a.employeeid;
### Lop Sheet for every Month.
LOPReport=SELECT a.employeesequenceno EMPCODE,a.callname EMPLOPYEENAME,b.name BU,31-ifnull(lop.lopcount,0) Paiddays, ifnull(lop.lopcount,0) LOP FROM hclhrm_prod.tbl_employee_primary a left join hcladm_prod.tbl_businessunit b on b.businessunitid=a.companyid left join hclhrm_prod.tbl_employee_lop lop on lop.employeeid=a.employeeid and lop.loptransactionid=? where b.callname=? and a.status='1001' group by a.employeeid 
#### CTC REPORT 
##CTCREPORT=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(HR.DATE,'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details',IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS', 'OTHERS_NOT_INCLUDED_IN_CTC', IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY' FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER WHERE bu.callname in ('HYD') group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO; 

#MasterSheet_Promoters=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details',IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS',  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER WHERE  bu.businessunitid in (25)  group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO; 
MasterSheet_Promoters=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS', co.NAME 'COSTCENTER',GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details', IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS', IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+    IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+ 	IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC 	FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A 	LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON 	A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU 	ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D 	ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC 	ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 and status=1001  group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER  LEFT JOIN hcladm_prod.tbl_costcenter co on co.COSTCENTERID=a.COSTCENTERID WHERE  bu.businessunitid in (25) group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO;

##MasterSheet_HYD=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details',IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS',  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER WHERE bu.callname in ('HYD') group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO; 
MasterSheet_HYD=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS',co.NAME 'COSTCENTER', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details', IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS', IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+    IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+ 	IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC 	FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A 	LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON 	A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU 	ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D 	ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC 	ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 and status=1001 group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER  LEFT JOIN hcladm_prod.tbl_costcenter co on co.COSTCENTERID=a.COSTCENTERID WHERE bu.callname in ('HYD') group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO ;


##bu.SHORTNAME in('DIASPA','VOLGA','SC','IB')
##MasterSheet=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details',IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS',  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER WHERE bu.SHORTNAME in('DIASPA','VOLGA','SC','IB')  group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO; 
MasterSheet=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS', co.NAME 'COSTCENTER',GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details', IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS', IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+    IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+ 	IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC 	FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A 	LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON 	A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU 	ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D 	ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC 	ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 and status=1001  group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER  LEFT JOIN hcladm_prod.tbl_costcenter co on co.COSTCENTERID=a.COSTCENTERID WHERE bu.SHORTNAME in('DIASPA','VOLGA','SC','IB') group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO;

##MasterSheet_MUM=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details',IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS',  IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+ IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+ IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER WHERE bu.callname in ('MUM') group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO; 
MasterSheet_MUM=SELECT A.EMPLOYEESEQUENCENO 'Emp ID', A.CALLNAME 'NAME', STATUS.NAME 'STATUS',co.NAME 'COSTCENTER', GEN.NAME 'GENDER', EMPLO.NAME 'EMPLOYMENT TYPE', IFNULL(STROKE.NAME,'--') 'INCREMENT TYPE', IFNULL(IF(STATUS.NAME='ACTIVE','--',HR.DATE),'') 'LWD', DATE_FORMAT(A.DATEOFBIRTH,'%d-%m-%Y') 'DOB', IFNULL(DATE_FORMAT(PROFILE.DATEOFJOIN,'%d-%m-%Y'),'') DOJ, BU.NAME 'DIVISION', IFNULL(DES.NAME,'') 'DESIGNATION', IFNULL(DEP.NAME,'') 'DEPARTMENT', CONCAT(MN.EMPLOYEESEQUENCENO,'-',MN.CALLNAME) 'Reportee', IFNULL(BANK.BANKNAME,   '') 'BANKNAME', IFNULL(BIFSC.BANKIFC,'') 'IFSC', IFNULL(OTHER.ACCOUNTNO,'') 'ACCOUNTNO', IFNULL(PRO.EMAIL,'') 'PROEMAIL', IFNULL(D.EMAIL,'') 'PEMAIL', IFNULL(OTHER.PFNO,     '') PFNO, IFNULL(OTHER.ESINO,    '')ESINO, IFNULL(OTHER.PFUAN,    '')PFUAN, IFNULL(EMPST.STATE,'') STATE, IFNULL(HQLOC.NAME,'') HQ, IFNULL(RLOC.NAME,'') REGION, IFNULL(PRO.MOBILE,'') 'PROFESSIONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL_MOBILE', IFNULL(D.MOBILE,'')'PERSONAL PHONE', IFNULL(D.COMMUNICATIONADDRESS,'')COMMUNICATIONADDRESS, IFNULL(D.COMMUNICATIONADDRESS2,'')COMMUNICATIONADDRESS2, IFNULL(D.COMMUNICATIONADDRESS3,'')COMMUNICATIONADDRESS3, IFNULL(D.COMMUNICATIONADDRESS4,'')COMMUNICATIONADDRESS4, IFNULL(COMMLOC.NAME,'') COMMCITY,IFNULL(COMMSTATELOC.NAME,'')COMMSTATE, IFNULL(D.COMMUNICATIONZIP,'') COMM_ZIP, IFNULL(D.PERMANENTADDRESS,'')PERMANENTADDRESS, IFNULL(D.PERMANENTADDRESS2,'')PERMANENTADDRESS2, IFNULL(D.PERMANENTADDRESS3,'')PERMANENTADDRESS3, IFNULL(D.PERMANENTADDRESS4,'')PERMANENTADDRESS4, IFNULL(PLOC.NAME,'') PCITY, IFNULL(PSLOC.NAME,'')PSTATE,IFNULL(D.PERMANENTZIP,'') PZIPCODE, IFNULL(INFO.PASSPORTNO,'') 'PASSPORTNO', IFNULL(INFO.AADHAARCARDNO,'') 'AADHAARCARDNO', IFNULL(INFO.AADHAARUID,'') 'AADHAARUID', IFNULL(INFO.AADHAARNAME,'') 'AADHAARNAME', IFNULL(INFO.PAN,'') 'PAN', IFNULL(IMPRS.assetpropertyvalue,'0.00') 'IMPRESTAMT', QUALI.QUALIFICATION 'Education Details', IFNULL(PREV.PREV,'0') 'Prev.Exp',CUREXP.Exp 'Cur.Exp', IFNULL(MAX(IF(CTCD.COMPONENTID=22,CTCD.COMPONENTVALUE,0)),'0')'GROSS', IFNULL(MAX(IF(CTCD.COMPONENTID=24,CTCD.COMPONENTVALUE,0)),'0')'BASIC', IFNULL(MAX(IF(CTCD.COMPONENTID=25,CTCD.COMPONENTVALUE,0)),'0')'HRA', IFNULL(MAX(IF(CTCD.COMPONENTID=26,CTCD.COMPONENTVALUE,0)),'0')'CA', IFNULL(MAX(IF(CTCD.COMPONENTID=27,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL', IFNULL(MAX(IF(CTCD.COMPONENTID=28,CTCD.COMPONENTVALUE,0)),'0')'EDUCATION', IFNULL(MAX(IF(CTCD.COMPONENTID=29,CTCD.COMPONENTVALUE,0)),'0')'SPL ALLOW', IFNULL(MAX(IF(CTCD.COMPONENTID=18,CTCD.COMPONENTVALUE,0)),'0')'TRAVEL ALLOWANCE', IFNULL(MAX(IF(CTCD.COMPONENTID=70,CTCD.COMPONENTVALUE,0)),'0')'KIT ALLOWANCE-E', IFNULL(MAX(IF(CTCD.COMPONENTID=97,CTCD.COMPONENTVALUE,0)),'0')'LTA-E', IFNULL(MAX(IF(CTCD.COMPONENTID=98,CTCD.COMPONENTVALUE,0)),'0')'BONUS-E', IFNULL(EMPST.STATE,'') 'PTSTATE', IFNULL(MAX(IF(CTCD.COMPONENTID=30,CTCD.COMPONENTVALUE,0)),'0')'PT-D', IFNULL(MAX(IF(CTCD.COMPONENTID=31,CTCD.COMPONENTVALUE,0)),'0')'PF-D', IFNULL(MAX(IF(CTCD.COMPONENTID=32,CTCD.COMPONENTVALUE,0)),'0')'ESI-D', IFNULL(MAX(IF(CTCD.COMPONENTID=33,CTCD.COMPONENTVALUE,0)),'0')'LTA-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=34,CTCD.COMPONENTVALUE,0)),'0')'PF-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=35,CTCD.COMPONENTVALUE,0)),'0')'ESI-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=36,CTCD.COMPONENTVALUE,0)),'0')'BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=62,CTCD.COMPONENTVALUE,0)),'0')'GRATUITY-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=39,CTCD.COMPONENTVALUE,0)),'0')'ANNUAL BONUS-ANNUAL BENIFITS', IFNULL(MAX(IF(CTCD.COMPONENTID=93,CTCD.COMPONENTVALUE,0)),'0')'MEDICAL PREMIUM-ANNUAL BENIFITS', IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')'FUELANDMAINTENANCE', IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')'OTHERCOMPONENTS', IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')'MOBILE', IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')'INTERNET', IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')'HOUSERENT', IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0')'DRIVERSALARY',  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=22 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=97 THEN CTCD.COMPONENTVALUE*12 END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=98 THEN CTCD.COMPONENTVALUE*12 END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=34 THEN CTCD.COMPONENTVALUE END),0)+  IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=35 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=36 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=33 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=39 THEN CTCD.COMPONENTVALUE END),0)+   IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=62 THEN CTCD.COMPONENTVALUE END),0)+    IFNULL(MAX(CASE WHEN CTCD.COMPONENTID=93 THEN CTCD.COMPONENTVALUE END),0)+ 	IFNULL(MAX(IF(xx.COMPONENTID=9001,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9002,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9003,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9004,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9005,xy.COMPONENTVALUE,0)),'0')+ 	IFNULL(MAX(IF(xx.COMPONENTID=9006,xy.COMPONENTVALUE,0)),'0') CTC 	FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A 	LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES STATUS ON 	A.STATUS=STATUS.STATUS LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT BU 	ON A.COMPANYID=BU.BUSINESSUNITID LEFT JOIN hclhrm_prod.tbl_employee_personal_contact D 	ON A.EMPLOYEEID=D.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PLOC 	ON D.PERMANENTLOCATIONID=PLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION PSLOC ON PLOC.PARENT=PSLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMLOC ON D.COMMUNICATIONLOCATIONID=COMMLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION COMMSTATELOC ON COMMLOC.PARENT=COMMSTATELOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_profile PROFILE ON A.EMPLOYEEID=PROFILE.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_professional_details DD ON A.EMPLOYEEID=DD.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT DEP ON DD.DEPARTMENTID=DEP.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION DES ON DD.DESIGNATIONID=DES.DESIGNATIONID LEFT JOIN test.empl_states EMPST ON A.EMPLOYEEID=EMPST.EMPLOYEEID LEFT JOIN HCLLCM_PROD.TBL_LOCATION RLOC ON DD.SUBLOCATIONID=RLOC.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION HQLOC ON DD.WORKLOCATIONID=HQLOC.LOCATIONID LEFT JOIN hclhrm_prod.tbl_employee_other_detail OTHER ON A.EMPLOYEEID=OTHER.EMPLOYEEID LEFT JOIN hclhrm_prod_others.tbl_emp_bank_ifc BIFSC ON A.EMPLOYEEID=BIFSC.EMPID LEFT JOIN hcladm_prod.tbl_bank_details BANK ON OTHER.BANKID=BANK.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY MN ON DD.MANAGERID=MN.EMPLOYEEID LEFT JOIN hclhrm_prod.tbl_employee_personalinfo INFO ON A.EMPLOYEEID=INFO.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID ctcempid,max(CTCTRANSACTIONID) Maxid FROM HCLHRM_PROD.TBL_EMPLOYEE_CTC group by employeeid )CTC ON CTC.ctcempid=A.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_CTC_DETAILS CTCD ON CTCD.CTCTRANSACTIONID=CTC.Maxid LEFT JOIN hclhrm_prod.tbl_employee_professional_contact PRO ON A.EMPLOYEEID=PRO.EMPLOYEEID  LEFT JOIN test.fuel_maintenance XY ON XY.CTCTRANSACTIONID=CTC.Maxid AND XY.employeeid=A.EMPLOYEEID LEFT JOIN test.tbl_new_components XX ON XX.COMPONENTID=XY.COMPONENTID   LEFT JOIN ( SELECT EMPLOYEEID,MAX(LASTWORKINGDATE) DATE FROM HCLHRM_PROD.TBL_EMPLOYEE_HRACTIONS GROUP BY EMPLOYEEID ) HR ON A.EMPLOYEEID=HR.EMPLOYEEID LEFT JOIN (  select  assetpropertyvalue,issueddate,returneddate,employeeid from hclhrm_prod.tbl_employee_assets where assetid=16 and status=1001  group by employeeid )IMPRS ON IMPRS.employeeid=A.employeeid LEFT JOIN ( SELECT EMPLOYEEID,GROUP_CONCAT(QUALIFICATIONID,'-',YEAROFPASSING) QUALIFICATION FROM hclhrm_prod.tbl_employee_education_details GROUP BY EMPLOYEEID ) QUALI ON A.EMPLOYEEID=QUALI.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,ROUND((TIMESTAMPDIFF(MONTH, DATEOFJOIN, NOW())+1)/12,'1') 'Exp' FROM HCLHRM_PROD.TBL_EMPLOYEE_PROFILE GROUP BY EMPLOYEEID ) CUREXP ON A.EMPLOYEEID=CUREXP.EMPLOYEEID LEFT JOIN ( SELECT EMPLOYEEID,SUM(ROUND(EXPERIENCE/12,1)) PREV FROM hclhrm_prod.tbl_employee_experience_details GROUP BY EMPLOYEEID ) PREV ON A.EMPLOYEEID=PREV.EMPLOYEEID LEFT JOIN HCLHRM_PROD.tbl_employment_types EMPLO ON A.EMPLOYMENTTYPEID=EMPLO.EMPLOYMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_increment_type STROKE ON DD.INCREMENTTYPEID=STROKE.INCREMENTTYPEID LEFT JOIN HCLADM_PROD.tbl_gender GEN ON A.GENDER=GEN.GENDER  LEFT JOIN hcladm_prod.tbl_costcenter co on co.COSTCENTERID=a.COSTCENTERID WHERE bu.callname in ('MUM')  group by a.employeeid ORDER BY A.EMPLOYEESEQUENCENO;


###### PaySheet
						
PAYSHEET_MUM=CALL procedure.paysheet((SELECT GROUP_CONCAT(BUSINESSUNITID) FROM hcladm_prod.tbl_businessunit where callname='MUM'),DATE_FORMAT(CURDATE(),'%Y%m'));

PAYSHEET_HYD=CALL procedure.paysheet((SELECT GROUP_CONCAT(BUSINESSUNITID) FROM hcladm_prod.tbl_businessunit where callname='HYD' AND BUSINESSUNITID NOT IN(25)),DATE_FORMAT(CURDATE(),'%Y%m'));

PAYSHEET_Promoters=CALL procedure.paysheet(25,DATE_FORMAT(CURDATE(),'%Y%m'));	

#######	Bank Statements				

Bank_Statement=CALL test_mum.BankStatement('201901','E','HYD');				

Bank_Statement_MUM=SELECT A.EMPLOYEESEQUENCENO EmpCode,A.CALLNAME EmpName,DATE_FORMAT(M.DATEOFJOIN,'%d-%m-%Y')DOJ,C.SHORTNAME 'Div',D.CODE Dept,E.CODE Desig, J.STATE State,IFNULL(H.NAME,'--') Region,IFNULL(I.NAME,'--') HQ, CAST(G.PAYABLEDAYS AS DECIMAL(10,1)) PaidDays, L.BANKNAME Bank,IFNULL(K.BANKIFC,'--') IFSC,F.ACCOUNTNO 'A/c No', G.NETVALUE 'Amount (Rs.)', N.NAME Status FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PROFESSIONAL_DETAILS B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT C ON A.COMPANYID=C.BUSINESSUNITID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT D ON B.DEPARTMENTID=D.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION E ON B.DESIGNATIONID=E.DESIGNATIONID JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAYPERIOD_DETAILS F ON A.EMPLOYEESEQUENCENO=F.EMPLOYEESEQUENCENO LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA G ON F.EMPLOYEEID=G.EMPLOYEEID AND G.PAYPERIOD=F.PAYPERIOD LEFT JOIN HCLLCM_PROD.TBL_LOCATION H ON B.SUBLOCATIONID=H.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION I ON F.WORKLOCATIONID=I.LOCATIONID LEFT JOIN TEST.EMPL_STATES J ON A.EMPLOYEESEQUENCENO=J.EMPLOYEESEQUENCENO LEFT JOIN HCLHRM_PROD_OTHERS.TBL_EMP_BANK_IFC K ON A.EMPLOYEEID=K.EMPID AND F.ACCOUNTNO=K.BANKACC LEFT JOIN HCLADM_PROD.TBL_BANK_DETAILS L ON L.BANKID=F.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PROFILE M ON A.EMPLOYEEID=M.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES N ON A.STATUS=N.STATUS WHERE F.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND G.STATUS=1001 AND C.CALLNAME IN ('MUM') AND G.COMPONENTID=46 ORDER BY M.DATEOFJOIN DESC;

Bank_Statement_Hyd=SELECT A.EMPLOYEESEQUENCENO EmpCode,A.CALLNAME EmpName,DATE_FORMAT(M.DATEOFJOIN,'%d-%m-%Y')DOJ,C.SHORTNAME 'Div',D.CODE Dept,E.CODE Desig, J.STATE State,IFNULL(H.NAME,'--') Region,IFNULL(I.NAME,'--') HQ, CAST(G.PAYABLEDAYS AS DECIMAL(10,1)) PaidDays, L.BANKNAME Bank,IFNULL(K.BANKIFC,'--') IFSC,F.ACCOUNTNO 'A/c No', G.NETVALUE 'Amount (Rs.)', N.NAME Status FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PROFESSIONAL_DETAILS B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT C ON A.COMPANYID=C.BUSINESSUNITID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT D ON B.DEPARTMENTID=D.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION E ON B.DESIGNATIONID=E.DESIGNATIONID JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAYPERIOD_DETAILS F ON A.EMPLOYEESEQUENCENO=F.EMPLOYEESEQUENCENO LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA G ON F.EMPLOYEEID=G.EMPLOYEEID AND G.PAYPERIOD=F.PAYPERIOD LEFT JOIN HCLLCM_PROD.TBL_LOCATION H ON B.SUBLOCATIONID=H.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION I ON F.WORKLOCATIONID=I.LOCATIONID LEFT JOIN TEST.EMPL_STATES J ON A.EMPLOYEESEQUENCENO=J.EMPLOYEESEQUENCENO LEFT JOIN HCLHRM_PROD_OTHERS.TBL_EMP_BANK_IFC K ON A.EMPLOYEEID=K.EMPID AND F.ACCOUNTNO=K.BANKACC LEFT JOIN HCLADM_PROD.TBL_BANK_DETAILS L ON L.BANKID=F.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PROFILE M ON A.EMPLOYEEID=M.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES N ON A.STATUS=N.STATUS WHERE F.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND G.STATUS=1001 AND C.CALLNAME IN ('HYD') AND G.COMPONENTID=46 ORDER BY M.DATEOFJOIN DESC;

Bank_Statement_Promoters=SELECT A.EMPLOYEESEQUENCENO EmpCode,A.CALLNAME EmpName,DATE_FORMAT(M.DATEOFJOIN,'%d-%m-%Y')DOJ,C.SHORTNAME 'Div',D.CODE Dept,E.CODE Desig, J.STATE State,IFNULL(H.NAME,'--') Region,IFNULL(I.NAME,'--') HQ, CAST(G.PAYABLEDAYS AS DECIMAL(10,1)) PaidDays, L.BANKNAME Bank,IFNULL(K.BANKIFC,'--') IFSC,F.ACCOUNTNO 'A/c No', G.NETVALUE 'Amount (Rs.)', N.NAME Status FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PROFESSIONAL_DETAILS B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT C ON A.COMPANYID=C.BUSINESSUNITID LEFT JOIN HCLADM_PROD.TBL_DEPARTMENT D ON B.DEPARTMENTID=D.DEPARTMENTID LEFT JOIN HCLADM_PROD.TBL_DESIGNATION E ON B.DESIGNATIONID=E.DESIGNATIONID JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAYPERIOD_DETAILS F ON A.EMPLOYEESEQUENCENO=F.EMPLOYEESEQUENCENO LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA G ON F.EMPLOYEEID=G.EMPLOYEEID AND G.PAYPERIOD=F.PAYPERIOD LEFT JOIN HCLLCM_PROD.TBL_LOCATION H ON B.SUBLOCATIONID=H.LOCATIONID LEFT JOIN HCLLCM_PROD.TBL_LOCATION I ON F.WORKLOCATIONID=I.LOCATIONID LEFT JOIN TEST.EMPL_STATES J ON A.EMPLOYEESEQUENCENO=J.EMPLOYEESEQUENCENO LEFT JOIN HCLHRM_PROD_OTHERS.TBL_EMP_BANK_IFC K ON A.EMPLOYEEID=K.EMPID AND F.ACCOUNTNO=K.BANKACC LEFT JOIN HCLADM_PROD.TBL_BANK_DETAILS L ON L.BANKID=F.BANKID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PROFILE M ON A.EMPLOYEEID=M.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_STATUS_CODES N ON A.STATUS=N.STATUS WHERE F.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND G.STATUS=1001 AND C.BUSINESSUNITID=25 AND G.COMPONENTID=46 ORDER BY M.DATEOFJOIN DESC;						


#######ESI STATEMENTS FOR HYD

###SELECT DISTINCT ESICODE FROM HCLADM_PROD.TBL_BUSINESSUNIT WHERE CALLNAME='HYD'

##52000261630001001,79000700500000003,43520261630011001,37790700500010003

HYD_ESI_STATEMENTS=SELECT F.ESINO 'IP Number',E.NAME,A.CALLNAME 'IP Name',D.PAYABLEDAYS 'No of Days for which wages paid/payable during the month', SUM(CASE WHEN D.COMPONENTID IN (22,97,98,87) THEN D.NETVALUE END)'Total Monthly Wages', 0 'Reason Code for Zero workings days','' AS 'Last Working Day', MAX(CASE WHEN D.COMPONENTID IN (32) THEN D.NETVALUE END)ESI FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A JOIN HCLHRM_PROD.TBL_EMPLOYEE_PROFILE B ON A.EMPLOYEEID=B.EMPLOYEEID JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAYPERIOD_DETAILS C ON A.EMPLOYEESEQUENCENO=C.EMPLOYEESEQUENCENO JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA D ON C.EMPLOYEEID=D.EMPLOYEEID AND C.PAYPERIOD=D.PAYPERIOD LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT E ON A.COMPANYID=E.BUSINESSUNITID AND E.STATUS=1001 JOIN HCLHRM_PROD.TBL_EMPLOYEE_OTHER_DETAIL F ON A.EMPLOYEEID=F.EMPLOYEEID WHERE E.CALLNAME IN ('HYD') AND E.ESICODE IN (?) AND C.PAYPERIOD IN (DATE_FORMAT(CURDATE(),'%Y%m')) GROUP BY A.EMPLOYEESEQUENCENO HAVING ESI!=0 ORDER BY F.ESINO DESC;

ESI_CODES=52000261630001001,79000700500000003,43520261630011001,37790700500010003

######ESI STATEMENT FOR MUM

MUM_ESI_STATEMENTS=SELECT F.ESINO 'IP Number',E.NAME,A.CALLNAME 'IP Name',D.PAYABLEDAYS 'No of Days for which wages paid/payable during the month', SUM(CASE WHEN D.COMPONENTID IN (22,97,98,87) THEN D.NETVALUE END)'Total Monthly Wages', 0 'Reason Code for Zero workings days','' AS 'Last Working Day', MAX(CASE WHEN D.COMPONENTID IN (32) THEN D.NETVALUE END)ESI FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A JOIN HCLHRM_PROD.TBL_EMPLOYEE_PROFILE B ON A.EMPLOYEEID=B.EMPLOYEEID JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAYPERIOD_DETAILS C ON A.EMPLOYEESEQUENCENO=C.EMPLOYEESEQUENCENO JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA D ON C.EMPLOYEEID=D.EMPLOYEEID AND C.PAYPERIOD=D.PAYPERIOD LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT E ON A.COMPANYID=E.BUSINESSUNITID AND E.STATUS=1001 JOIN HCLHRM_PROD.TBL_EMPLOYEE_OTHER_DETAIL F ON A.EMPLOYEEID=F.EMPLOYEEID WHERE E.CALLNAME IN ('MUM') AND C.PAYPERIOD IN (DATE_FORMAT(CURDATE(),'%Y%m')) GROUP BY A.EMPLOYEESEQUENCENO HAVING ESI!=0 ORDER BY F.ESINO DESC;
 
### Arrears PF  
 
Arrears_PF_HYD=SELECT A.EMPLOYEESEQUENCENO ID,B.PFUAN,A.CALLNAME 'MEMBER NAME', MAX(CASE WHEN C.COMPONENTID=87 THEN (C.NETVALUE*0.5) END)'EPF WAGES', IF(MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END)<=15000,MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END),15000.00)'EPS WAGES', IF(MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END)<=15000,MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END),15000.00)'EDLI Wages', MAX(CASE WHEN C.COMPONENTID=87 THEN (C.NETVALUE*0.5)*0.12 END)'EPF Contribution(EE Share) due', ROUND(IF(MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END)<=15000,MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END),15000)*0.0833)'EPS Contribution due' FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A JOIN HCLHRM_PROD.TBL_EMPLOYEE_OTHER_DETAIL B ON A.EMPLOYEEID=B.EMPLOYEEID JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA C ON A.EMPLOYEEID=C.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_LOP D ON A.EMPLOYEEID=D.EMPLOYEEID AND D.LOPTRANSACTIONID=DATE_FORMAT(CURDATE(),'%Y%m') LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT E ON A.COMPANYID=E.BUSINESSUNITID WHERE E.CALLNAME IN ('HYD') AND C.STATUS=1001 AND C.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND A.EMPLOYMENTTYPEID!=7 AND C.COMPONENTID IN (87) AND C.NETVALUE!=0 GROUP BY A.EMPLOYEESEQUENCENO;
 
Arrears_PF_MUM=SELECT A.EMPLOYEESEQUENCENO ID,B.PFUAN,A.CALLNAME 'MEMBER NAME', MAX(CASE WHEN C.COMPONENTID=87 THEN (C.NETVALUE*0.5) END)'EPF WAGES', IF(MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END)<=15000,MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END),15000.00)'EPS WAGES', IF(MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END)<=15000,MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END),15000.00)'EDLI Wages', MAX(CASE WHEN C.COMPONENTID=87 THEN (C.NETVALUE*0.5)*0.12 END)'EPF Contribution(EE Share) due', ROUND(IF(MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END)<=15000,MAX(CASE WHEN C.COMPONENTID=87 THEN C.NETVALUE*0.5 END),15000)*0.0833)'EPS Contribution due' FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A JOIN HCLHRM_PROD.TBL_EMPLOYEE_OTHER_DETAIL B ON A.EMPLOYEEID=B.EMPLOYEEID JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA C ON A.EMPLOYEEID=C.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_LOP D ON A.EMPLOYEEID=D.EMPLOYEEID AND D.LOPTRANSACTIONID=DATE_FORMAT(CURDATE(),'%Y%m') LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT E ON A.COMPANYID=E.BUSINESSUNITID WHERE E.CALLNAME IN ('MUM') AND C.STATUS=1001 AND C.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND A.EMPLOYMENTTYPEID!=7 AND C.COMPONENTID IN (87) AND C.NETVALUE!=0 GROUP BY A.EMPLOYEESEQUENCENO;

####PF STATEMENTS FOR HYD

PF_STATEMENT_HYD=SELECT A.EMPLOYEESEQUENCENO ID,B.PFUAN,A.CALLNAME 'MEMBER NAME', MAX(CASE WHEN C.COMPONENTID=22 THEN C.NETVALUE END)+ MAX(CASE WHEN C.COMPONENTID=97 THEN C.NETVALUE END)+ MAX(CASE WHEN C.COMPONENTID=98 THEN C.NETVALUE END) 'GROSS WAGES', MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)'EPF WAGES', IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),A.DATEOFBIRTH)/365.25)>58,0.00,IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000.00))'EPS WAGES', IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000.00)'EDLI Wages', MAX(CASE WHEN C.COMPONENTID=31 THEN C.NETVALUE END)'EPF Contribution(EE Share) due', IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),A.DATEOFBIRTH)/365.25)>58,0.00,ROUND(IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000)*0.0833))'EPS Contribution due', ROUND((MAX(CASE WHEN C.COMPONENTID=31 THEN C.NETVALUE END))-( IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),DATEOFBIRTH)/365.25)>58,0,ROUND(IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000)*0.0833))))'Diff EPF and EPS Contrbution(ER Share)due', IFNULL(D.LOPCOUNT,'') AS 'NCP Days', '' as 'Refund of Advances' FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_OTHER_DETAIL B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA C ON A.EMPLOYEEID=C.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_LOP D ON A.EMPLOYEEID=D.EMPLOYEEID AND D.LOPTRANSACTIONID=DATE_FORMAT(CURDATE(),'%Y%m') LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT E ON A.COMPANYID=E.BUSINESSUNITID AND E.STATUS=1001 WHERE C.STATUS=1001 AND C.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND A.EMPLOYMENTTYPEID!=7 AND E.CALLNAME IN ('HYD') AND E.CODE IN ('HHC') GROUP BY A.EMPLOYEESEQUENCENO;

PF_STATEMENT_AZISTA=SELECT A.EMPLOYEESEQUENCENO ID,B.PFUAN,A.CALLNAME 'MEMBER NAME', MAX(CASE WHEN C.COMPONENTID=22 THEN C.NETVALUE END)+ MAX(CASE WHEN C.COMPONENTID=97 THEN C.NETVALUE END)+ MAX(CASE WHEN C.COMPONENTID=98 THEN C.NETVALUE END) 'GROSS WAGES', MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)'EPF WAGES', IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),A.DATEOFBIRTH)/365.25)>58,0.00,IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000.00))'EPS WAGES', IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000.00)'EDLI Wages', MAX(CASE WHEN C.COMPONENTID=31 THEN C.NETVALUE END)'EPF Contribution(EE Share) due', IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),A.DATEOFBIRTH)/365.25)>58,0.00,ROUND(IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000)*0.0833))'EPS Contribution due', ROUND((MAX(CASE WHEN C.COMPONENTID=31 THEN C.NETVALUE END))-( IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),DATEOFBIRTH)/365.25)>58,0,ROUND(IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000)*0.0833))))'Diff EPF and EPS Contrbution(ER Share)due', IFNULL(D.LOPCOUNT,'') AS 'NCP Days', '' as 'Refund of Advances' FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_OTHER_DETAIL B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA C ON A.EMPLOYEEID=C.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_LOP D ON A.EMPLOYEEID=D.EMPLOYEEID AND D.LOPTRANSACTIONID=DATE_FORMAT(CURDATE(),'%Y%m') LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT E ON A.COMPANYID=E.BUSINESSUNITID AND E.STATUS=1001 WHERE C.STATUS=1001 AND C.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND A.EMPLOYMENTTYPEID!=7 AND E.CALLNAME IN ('HYD') AND E.CODE IN ('AZISTA') GROUP BY A.EMPLOYEESEQUENCENO;

###PF STATEMENTS FOR MUM

PF_STATEMENT_MUM=SELECT A.EMPLOYEESEQUENCENO ID,B.PFUAN,A.CALLNAME 'MEMBER NAME', MAX(CASE WHEN C.COMPONENTID=22 THEN C.NETVALUE END)+ MAX(CASE WHEN C.COMPONENTID=97 THEN C.NETVALUE END)+ MAX(CASE WHEN C.COMPONENTID=98 THEN C.NETVALUE END) 'GROSS WAGES', MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)'EPF WAGES', IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),A.DATEOFBIRTH)/365.25)>58,0.00,IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000.00))'EPS WAGES', IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000.00)'EDLI Wages', MAX(CASE WHEN C.COMPONENTID=31 THEN C.NETVALUE END)'EPF Contribution(EE Share) due', IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),A.DATEOFBIRTH)/365.25)>58,0.00,ROUND(IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000)*0.0833))'EPS Contribution due', ROUND((MAX(CASE WHEN C.COMPONENTID=31 THEN C.NETVALUE END))-( IF(FLOOR(DATEDIFF(DATE_FORMAT(NOW(),'%Y-%m-%d'),DATEOFBIRTH)/365.25)>58,0,ROUND(IF(MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END)<=15000,MAX(CASE WHEN C.COMPONENTID=24 THEN C.NETVALUE END),15000)*0.0833))))'Diff EPF and EPS Contrbution(ER Share)due', IFNULL(D.LOPCOUNT,'') AS 'NCP Days', '' as 'Refund of Advances' FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_OTHER_DETAIL B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA C ON A.EMPLOYEEID=C.EMPLOYEEID LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_LOP D ON A.EMPLOYEEID=D.EMPLOYEEID AND D.LOPTRANSACTIONID=DATE_FORMAT(CURDATE(),'%Y%m') LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT E ON A.COMPANYID=E.BUSINESSUNITID AND E.STATUS=1001 WHERE C.STATUS=1001 AND C.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND A.EMPLOYMENTTYPEID!=7 AND E.CALLNAME IN ('MUM') GROUP BY A.EMPLOYEESEQUENCENO;

###JV CODE FOR MUM

JV_CODE_MUM=SELECT J.EmpCode,J.JVCode,J.NAME,J.AMOUNT Amt FROM ( SELECT A.EMPLOYEESEQUENCENO EmpCode,C.GLCODE JVCode,C.NAME,B.COMPONENTID, B.NETVALUE Amount FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_PAY_COMPONENT C ON B.COMPONENTID=C.PAYCOMPONENTID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT D ON A.COMPANYID=D.BUSINESSUNITID WHERE B.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND B.STATUS=1001 AND A.EMPLOYEESEQUENCENO NOT IN (20206,10423) AND D.CALLNAME IN ('MUM') AND D.CODE='HHC' AND B.COMPONENTID NOT IN(22,23,43,44,45,46,47)  UNION ALL  SELECT A.EMPLOYEESEQUENCENO EmpCode,C.GLCODE JVCode,C.NAME,B.COMPONENTID, SUM(CASE WHEN B.COMPONENTID=46 THEN B.NETVALUE WHEN B.COMPONENTID=95 THEN -(B.NETVALUE) END) AS Amount FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_PAY_COMPONENT C ON B.COMPONENTID=C.PAYCOMPONENTID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT D ON A.COMPANYID=D.BUSINESSUNITID WHERE B.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND B.STATUS=1001 AND D.CALLNAME IN ('MUM') AND D.CODE='HHC' AND A.EMPLOYEESEQUENCENO NOT IN (20206,10423) AND B.COMPONENTID IN(46,95) GROUP BY A.EMPLOYEESEQUENCENO)J HAVING Amt!=0 ORDER BY EMPCODE,JVCODE;
 
JV_CODE_HHC=SELECT J.EmpCode,J.JVCode,J.NAME,J.AMOUNT Amt FROM ( SELECT A.EMPLOYEESEQUENCENO EmpCode,C.GLCODE JVCode,C.NAME,B.COMPONENTID, B.NETVALUE Amount FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_PAY_COMPONENT C ON B.COMPONENTID=C.PAYCOMPONENTID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT D ON A.COMPANYID=D.BUSINESSUNITID WHERE B.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND B.STATUS=1001 AND A.EMPLOYEESEQUENCENO NOT IN (20206,10423) AND D.CALLNAME IN ('HYD') AND D.CODE='HHC' AND B.COMPONENTID NOT IN(22,23,43,44,45,46,47)  UNION ALL  SELECT A.EMPLOYEESEQUENCENO EmpCode,C.GLCODE JVCode,C.NAME,B.COMPONENTID, SUM(CASE WHEN B.COMPONENTID=46 THEN B.NETVALUE WHEN B.COMPONENTID=95 THEN -(B.NETVALUE) END) AS Amount FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_PAY_COMPONENT C ON B.COMPONENTID=C.PAYCOMPONENTID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT D ON A.COMPANYID=D.BUSINESSUNITID WHERE B.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND B.STATUS=1001 AND D.CALLNAME IN ('HYD') AND D.CODE='HHC' AND A.EMPLOYEESEQUENCENO NOT IN (20206,10423) AND B.COMPONENTID IN(46,95) GROUP BY A.EMPLOYEESEQUENCENO)J HAVING Amt!=0 ORDER BY EMPCODE,JVCODE;

JV_CODE_AZISTA=SELECT J.EmpCode,J.JVCode,J.NAME,J.AMOUNT Amt FROM ( SELECT A.EMPLOYEESEQUENCENO EmpCode,C.GLCODE JVCode,C.NAME,B.COMPONENTID, B.NETVALUE Amount FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_PAY_COMPONENT C ON B.COMPONENTID=C.PAYCOMPONENTID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT D ON A.COMPANYID=D.BUSINESSUNITID WHERE B.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND B.STATUS=1001 AND A.EMPLOYEESEQUENCENO NOT IN (20206,10423) AND D.CALLNAME IN ('HYD') AND D.CODE='AZISTA' AND B.COMPONENTID NOT IN(22,23,43,44,45,46,47)  UNION ALL  SELECT A.EMPLOYEESEQUENCENO EmpCode,C.GLCODE JVCode,C.NAME,B.COMPONENTID, SUM(CASE WHEN B.COMPONENTID=46 THEN B.NETVALUE WHEN B.COMPONENTID=95 THEN -(B.NETVALUE) END) AS Amount FROM HCLHRM_PROD.TBL_EMPLOYEE_PRIMARY A LEFT JOIN HCLHRM_PROD.TBL_EMPLOYEE_PAY_DATA B ON A.EMPLOYEEID=B.EMPLOYEEID LEFT JOIN HCLADM_PROD.TBL_PAY_COMPONENT C ON B.COMPONENTID=C.PAYCOMPONENTID LEFT JOIN HCLADM_PROD.TBL_BUSINESSUNIT D ON A.COMPANYID=D.BUSINESSUNITID WHERE B.PAYPERIOD=DATE_FORMAT(CURDATE(),'%Y%m') AND B.STATUS=1001 AND D.CALLNAME IN ('HYD') AND D.CODE='AZISTA' AND A.EMPLOYEESEQUENCENO NOT IN (20206,10423) AND B.COMPONENTID IN(46,95) GROUP BY A.EMPLOYEESEQUENCENO)J HAVING Amt!=0 ORDER BY EMPCODE,JVCODE;

###Hiring Report for HYD

Hiring_Report=SELECT a.EMPLOYEESEQUENCENO Code, DATE_FORMAT(b.dateofjoin,'%d.%m.%Y') DATEOFJOIN,'X' INDICATOR,'H0' REA, '01' REASONFORACTION,'50002031' POSITION, IFNULL(XY.COMPANYMCODE,0) DIVCODE,'1' EMPGROUP,'1H' EMPSUBGROUP, REPLACE(if(C.NAME='Dr.' AND A.GENDER=1,'Mr.',if(C.NAME='Dr.' AND A.GENDER=2,'Ms.',C.NAME) ), ".", "") TITLE, A.FIRSTNAME FIRSTNAME, A.LASTNAME,A.GENDER GENDERKEY,DATE_FORMAT(A.DATEOFBIRTH,'%d.%m.%Y') DATEOFBIRTH,'IN' NATIONALITY, CONCAT(P.COMMUNICATIONADDRESS ,P.COMMUNICATIONADDRESS2 , P.COMMUNICATIONADDRESS3 ,P.COMMUNICATIONADDRESS4) 'STREETANDHOUSENUMBER' , CONCAT(P.PERMANENTADDRESS ,P.PERMANENTADDRESS2 , P.PERMANENTADDRESS3 ,P.PERMANENTADDRESS4 , LOC.NAME,',',PERMANENTZIP)  'ADDRESS', P.COMMUNICATIONZIP 'POSTALCODE',L.NAME 'CITY', '8' DAILYWORKHOURS,'6' WEEKLYWORKDAYS,'G1' PAYSCALEGROUP, 'L1' PAYSCALEVEL,'03' NOTICEPERIODFOREMPLOYER,'03' NOTICEPERIODFOREMPLOYEE,DATE_FORMAT(b.dateofjoin,'%d.%m.%Y') INITIALDATEOFHIRE, DATE_FORMAT(b.dateofjoin,'%d.%m.%Y') ENDOFTRAINING,DATE_FORMAT(b.dateofjoin,'%d.%m.%Y') ENDOFPROBATION,DATE_FORMAT(b.dateofjoin,'%d.%m.%Y') CONFIRMATIONDATE FROM hclhrm_prod.tbl_employee_primary a left join hclhrm_prod.tbl_employee_profile b on a.employeeid=b.employeeid left join  hcladm_prod.tbl_title c on c.title=a.title LEFT JOIN hclhrm_prod.tbl_employee_personal_contact P on p.employeeid=a.employeeid LEFT JOIN hcllcm_prod.tbl_location L on P.COMMUNICATIONLOCATIONID=L.LOCATIONID LEFT JOIN hcllcm_prod.tbl_location LOC on P.PERMANENTLOCATIONID=LOC.LOCATIONID left join hcladm_prod.tbl_businessunit XY ON XY.businessunitid=a.companyid LEFT JOIN HCLADM_PROD.TBL_TRANSACTION_DATES D ON A.COMPANYID=D.BUSINESSUNITID AND D.TRANSACTIONTYPEID=1 AND D.TRANSACTIONDURATION=DATE_FORMAT(CURDATE(),'%Y%m') where dateofjoin  between D.FROMDATE and D.TODATE and xy.callname='HYD';


